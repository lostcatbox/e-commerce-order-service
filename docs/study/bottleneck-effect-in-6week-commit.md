# 예상되는 병목 현상 및 해결 방안
- 프로젝트 진행 중 예상되는 병목 현상 부분 및 이를 해결하기 위한 방안

## 목차
- 인기 상품 판매량 조회
- 선착순 쿠폰 발급 요청
- 주문 프로세스(OrderFacade)에서 복합 트랜잭션 처리 지연

## 내용
### 인기 상품 판매량 조회
#### 병목 현상 이유
  - 많은 사용자가 동시에 조회할 가능성이 높다
  - 판매량 데이터에는 현재 [제품 이름, 가격] 정보를 갖고 있지않아, 추가적으로 매번 상품 정보를 join 해서 조회해야한다.

#### 해결 방안
  - **캐시 도입** : 인기 상품 판매량 데이터를 **주기적으로 캐싱하여** 빠른 조회 가능 (캐시 무효화 정책 설정 필수)
  - **반정규화** : 인기 상품 판매량 데이터에 제품 이름, 가격 정보를 추가하여 조회 시 join 필요 없도록 설계

### 선착순 쿠폰 발급 요청
#### 병목 현상 이유
  - 많은 사용자가 동시에 쿠폰 발급을 요청할 가능성이 높다

#### 해결 방안
  - **비동기 처리** :메시지 큐를 사용하여 쿠폰 발급 요청과 실제 쿠폰 발급 처리를 **비동기적으로 처리**

### 주문 프로세스(OrderFacade)에서 복합 트랜잭션 처리 지연
#### 병목 현상 이유
  - 주문 프로세스가 11단계의 복잡한 처리 과정을 하나의 트랜잭션으로 처리
  - 여러 도메인 서비스(사용자, 상품, 쿠폰, 결제, 포인트)를 순차적으로 호출
  - 트랜잭션이 길어질수록 데드락 가능성 증가

#### 해결 방안
  - **트랜잭션 범위 최소화** : 각 도메인별로 트랜잭션을 분리하고 보상 트랜잭션(Saga) 패턴 적용
  - **이벤트 기반 처리** : 도메인 이벤트를 통해 느슨한 결합 구조로 변경
  - **최적화된 순서** : 실패 가능성이 높은 검증 로직을 트랜잭션 시작 전에 수행
