


# 도메인 모델 설계

## 포인트 모델

- 의미
  - 유저별 포인트 모델이다.
- 정책
  - 잔액
    - 최소 잔액 = 0
    - 최대 잔액 = 2,000,000
  - 충전 시
    - 한번 충전 요청 시, **충전가능 금액의 범위는 [1~2,000,000]** 이여야 한다.
    - 기존 잔액 + 충전 요청 금액으로 잔액을 업데이트한다.
    - **기존 잔액 + 충전 요청 금액이 최대 잔액을 초과할 경우, 에러 발생**
  - 사용 시
    - 한번 사용 요청 시, **사용 가능 금액의 범위는 [1~2,000,000]** 이여야 한다.
    - 포인트 사용 요청 금액 - 기존 잔액으로 잔액을 업데이트한다.
    - **포인트 사용 요청 금액 - 기존 잔액은 최소 잔액(0) 보다 작은 경우, 에러발생**
- 필드 구성
  - 사용자 Id
  - 잔액



## 상품 모델

- 의미
  - 판매하는 상품의 정보를 포함한 모델이다.
- 정책
  - 재고량
    - 최소 재고량 = 0
    - 최대 재고량 = 1,000
  - 상품 판매 요청 시
    - 상품 재고량 - 상품 판매량을 계산하여, 재고량을 업데이트한다.
    - **상품 재고량 - 상품 판매량이 최소 재고량보다 작은 경우, 에러발생**
- 필드 구성
  - 상품 Id
  - 상품 설명
  - 판매 금액
  - 재고량



## 주문 모델

- 의미
  - 사용자가 상품 주문 시, 사용되는 주문 모델이다. (=주문서)
- 정책
  - 사용한 쿠폰
    - 사용자 Id
  - 주문 요청 시
    - 주문한 상품 목록을 검사한다.
      - 주문한 상품은 1 개 이상이여야 한다.
      - 주문한 상품량들은 모두 1 이상이여야 한다.
    - 사용한 쿠폰의 사용가능 여부를 검사한다.
    - 주문 상태를 주문 요청됨으로 주문을 생성한다.
  - 주문 결제 완료 시
    - 주문 상태를 주문 결제됨으로 변경한다.
  - 주문 완료 시
    - 주문 상태를 주문 완료됨으로 변경한다.
  - 주문 실패 시
    - 주문 상태를 주문 실패됨으로 변경한다.
- 필드 구성
  - 주문 Id
  - 주문한 사용자 Id
  - 주문한 상품 목록
    - 상품Id
    - 주문한 상품량
  - 주문 상태 [주문 요청됨, 주문 결제됨, 주문 완료됨, 주문 실패됨]
  - 사용한 쿠폰 Id
  - 결제 Id



## 결제 모델

- 의미
  - 주문서에 대한 결제 시, 사용되는 결제 모델이다.
- 정책
  - 결제 요청 시
    - 쿠폰 할인 요청하여, 쿠폰이 적용된 최종 결제 금액을 계산한다.
    - 최종 결제 금액은 0 이상 이여야 한다.
    - 결제 상태를 결제 요청됨으로 결제을 생성한다.
  - 결제 성공 시
    - 결제 상태를 결제 성공됨으로 변경한다.
  - 결제 실패 시
    - 결제 상태를 결제 실패됨으로 변경한다.
- 필드 구성
  - 결제 Id
  - 할인 전 결제 금액
  - 최종 결제 금액
  - 결제 상태 [결제 요청됨, 결제 성공됨, 결제 실패됨]



## 선착순 쿠폰 모델

- 의미
  - 선착순 쿠폰 모델이다.
- 정책
  - 할인 처리 시
    - 쿠폰 사용 가능 여부가 [사용 가능] 일 때만 사용가능하다.
    - 할인 대상 금액 - 쿠폰 할인 금액으로 계산하여, 할인된 금액을 반환한다.
  - 선착순 쿠폰 발급 시
    - 쿠폰 사용 가능 여부가 [사용 가능] 일 때만 사용가능하다.
    - 쿠폰 재고량이 1 감소시킨다.
    - 쿠폰 재고량은 0이하가 될 수 없다.
  - 사용 가능한 상태인지 확인
    - 쿠폰 사용 가능 여부가 [사용 가능] 일 때만 사용가능하다.
- 필드 구성
  - 선착순 쿠폰 Id
  - 쿠폰 설명
  - 쿠폰 할인 금액
  - 쿠폰 재고량
  - 쿠폰 사용 가능 여부 [사용 가능, 사용 불가]



## 유저 쿠폰 모델

- 의미
  - 선착순 쿠폰 발급되면, 생기는 유저 쿠폰의 모델이다.
- 정책
  - 쿠폰 사용 시
    - 선착순 쿠폰 Id이 사용가능한 상태인지 확인한다.
    - 쿠폰 상태가 미사용 인지 확인한다.
    - 쿠폰 상태를 사용으로 변경한다.
- 필드 구성
  - 사용자 Id
  - 선착순 쿠폰 Id
  - 쿠폰 상태 [발급됨, 사용됨]


